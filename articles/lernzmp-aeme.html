<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using LERNZmp with AEME • AEME</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using LERNZmp with AEME">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">AEME</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/aeme-inputs.html">AEME Inputs</a></li>
    <li><a class="dropdown-item" href="../articles/getting-started.html">Getting started</a></li>
    <li><a class="dropdown-item" href="../articles/intro-aeme.html">Introduction to AEME</a></li>
    <li><a class="dropdown-item" href="../articles/lernzmp-aeme.html">Using LERNZmp with AEME</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Using LERNZmp with AEME</h1>
            
      

      <div class="d-none name"><code>lernzmp-aeme.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <a href="https://limnotrack.shinyapps.io/LERNZmp/" class="external-link">Lake Ecosystem
Research New Zealand Model Platform (LERNZmp)</a> is a web platform that
provides a user-friendly interface to the lake ecosystem model output
for New Zealand lakes. The platform is designed to provide a simple way
to explore the model output across multiple lakes and also to compare
the model results with observed data.</p>
<p>The platform is located here: <a href="https://limnotrack.shinyapps.io/LERNZmp/" class="external-link">LERNZmp</a>. Select and
load a lake model output on the “Overview” tab. The model output can be
downloaded in the “Download Models” tab. This downloads a “.zip” folder
containing the model output for the selected lake(s) as “.rds” files and
a lake metadata file “LERNZmp_lake_metadata.csv”.</p>
</div>
<div class="section level2">
<h2 id="using-lernzmp-output-with-aeme">Using LERNZmp output with AEME<a class="anchor" aria-label="anchor" href="#using-lernzmp-output-with-aeme"></a>
</h2>
<p>Once you have downloaded the LERNZmp model output and unzipped the
folder, you should a similar file structure to the following:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">"lernzmp"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "LERNZmp_lake_metadata.csv" "LID11133.rds"             </span></span>
<span><span class="co">#&gt; [3] "LID40102.rds"</span></span></code></pre></div>
<div class="section level3">
<h3 id="lernzmp-metadata">LERNZmp metadata<a class="anchor" aria-label="anchor" href="#lernzmp-metadata"></a>
</h3>
<p>The metadata file contains information about the all the lakes in the
LERNZmp platform. This includes the lake ID, name surface area (ha),
region, geomorphic type, depth, depth measurement (measured or
predicted), data (no data/minimal data/limited and irregular/periodic
but sparse/seasonal but detailed) and lernzmp file name.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"lernzmp/LERNZmp_lake_metadata.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">metadata</span><span class="op">)</span></span>
<span><span class="co">#&gt;        ID            Name   Area     Region Geomorphic.type Depth</span></span>
<span><span class="co">#&gt; 1   LID 1           Onoke 622.34 Wellington       Shoreline  8.72</span></span>
<span><span class="co">#&gt; 2   LID 3 Kohangapiripiri  10.82 Wellington       Shoreline 14.43</span></span>
<span><span class="co">#&gt; 3   LID 4     Kohangatera  21.31 Wellington       Shoreline 14.80</span></span>
<span><span class="co">#&gt; 4 LID 119         LID 119  41.87 Wellington        Riverine  3.55</span></span>
<span><span class="co">#&gt; 5 LID 195         Nganoke   3.10 Wellington        Riverine  3.74</span></span>
<span><span class="co">#&gt; 6 LID 229          Pounui  45.95 Wellington        Tectonic    NA</span></span>
<span><span class="co">#&gt;   Depth.measurement         Data aeme_file</span></span>
<span><span class="co">#&gt; 1          Measured Minimal Data      LID1</span></span>
<span><span class="co">#&gt; 2         Predicted      No data      LID3</span></span>
<span><span class="co">#&gt; 3         Predicted      No data      LID4</span></span>
<span><span class="co">#&gt; 4         Predicted      No data    LID119</span></span>
<span><span class="co">#&gt; 5         Predicted      No data    LID195</span></span>
<span><span class="co">#&gt; 6         Predicted      No data    LID229</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="rds-files">RDS files<a class="anchor" aria-label="anchor" href="#rds-files"></a>
</h3>
<p>RDS files are binary files that store R objects, such as data sets,
and are a native format for R. RDS files preserve data types and classes
and are generally smaller than their text file counterparts. The AEME
objects are an S4 object of the class <code>Aeme</code>. This object
class an store model configuration, inputs and outputs and allows for
the easy transfer of a lake model setup.</p>
<p>The lakes included in this example have ID’s LID11133 and LID40102.
We will filter the metadata to examine these two lakes.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">metadata</span> <span class="op">&lt;-</span> <span class="va">metadata</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">aeme_file</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LID11133"</span>, <span class="st">"LID40102"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">metadata</span></span>
<span><span class="co">#&gt;          ID    Name    Area        Region Geomorphic.type Depth</span></span>
<span><span class="co">#&gt; 1 LID 11133 Rotorua 8060.23 Bay of Plenty        Volcanic 45.27</span></span>
<span><span class="co">#&gt; 2 LID 40102  Rotoma 1113.68 Bay of Plenty        Volcanic 89.13</span></span>
<span><span class="co">#&gt;   Depth.measurement                  Data aeme_file</span></span>
<span><span class="co">#&gt; 1          Measured Seasonal but Detailed  LID11133</span></span>
<span><span class="co">#&gt; 2          Measured Seasonal but Detailed  LID40102</span></span></code></pre></div>
<p>These are lakes Rotorua (LID11133) and Rotoma (LID40102),
respectively.</p>
</div>
</div>
<div class="section level2">
<h2 id="build-aeme-models">Build AEME models<a class="anchor" aria-label="anchor" href="#build-aeme-models"></a>
</h2>
<p>We will now build AEME models for these two lakes using the LERNZmp
model output. We will first load the AEME object from the “.rds”
files.</p>
<p>The <code>Aeme</code> object contains the lake metadata, model
output, and model controls. More details can be found
<code><a href="../articles/intro-aeme.html">vignette("intro-aeme")</a></code>. It is an S4 object of the class
<code>Aeme</code>.</p>
<p>First, make sure to install the <code>AEME</code> package.</p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Loading metadata database</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Loading metadata database ... done</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; → Will <span style="font-style: italic;">install</span> 49 packages.</span></span>
<span><span class="co">#&gt; → Will <span style="font-style: italic;">update</span> 1 package.</span></span>
<span><span class="co">#&gt; → Will <span style="font-style: italic;">download</span> 49 CRAN packages (119.38 MB), cached: 1 (0 B).</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">AEME</span>          0.1.0 → 0.1.0    [bld][cmp] (GitHub: 147a74a)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">classInt</span>              0.4-10   [cmp][dl] <span style="color: #555555;">(505.04 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">cli</span>                   3.6.3    [cmp][dl] <span style="color: #555555;">(1.36 MB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">colorspace</span>            2.1-1    [cmp][dl] <span style="color: #555555;">(2.67 MB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">DBI</span>                   1.2.3    [dl] <span style="color: #555555;">(937.78 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">dplyr</span>                 1.1.4    [cmp][dl] <span style="color: #555555;">(1.58 MB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">e1071</span>                 1.7-16   [cmp][dl] <span style="color: #555555;">(671.93 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">fansi</span>                 1.0.6    [cmp][dl] <span style="color: #555555;">(322.97 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">farver</span>                2.1.2    [cmp][dl] <span style="color: #555555;">(1.52 MB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">generics</span>              0.1.3    [dl] <span style="color: #555555;">(83.69 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">ggplot2</span>               3.5.1    [dl] <span style="color: #555555;">(5.01 MB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">glue</span>                  1.8.0    [cmp][dl] <span style="color: #555555;">(183.78 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">gtable</span>                0.3.6    [dl] <span style="color: #555555;">(249.79 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">isoband</span>               0.2.7    [cmp][dl] <span style="color: #555555;">(1.93 MB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">labeling</span>              0.4.3    [dl] <span style="color: #555555;">(63.36 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">lifecycle</span>             1.0.4    [dl] <span style="color: #555555;">(140.93 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">lubridate</span>             1.9.3    [cmp][dl] <span style="color: #555555;">(987.20 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">lwgeom</span>                0.2-14   [cmp][dl] <span style="color: #555555;">(10.95 MB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">magrittr</span>              2.0.3    [cmp][dl] <span style="color: #555555;">(229.42 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">munsell</span>               0.5.1    [dl] <span style="color: #555555;">(244.68 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">ncdf4</span>                 1.23     [cmp][dl] <span style="color: #555555;">(7.29 MB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">patchwork</span>             1.3.0    [dl] <span style="color: #555555;">(3.35 MB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">pillar</span>                1.9.0    [dl] <span style="color: #555555;">(663.33 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">pkgconfig</span>             2.0.3    [dl] <span style="color: #555555;">(22.81 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">plyr</span>                  1.8.9    [cmp][dl] <span style="color: #555555;">(1.11 MB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">proxy</span>                 0.4-27   [cmp][dl] <span style="color: #555555;">(181.19 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">psychrolib</span>            2.5.2    [cmp][dl] <span style="color: #555555;">(487.49 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">purrr</span>                 1.0.2    [cmp][dl] <span style="color: #555555;">(510.64 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">R6</span>                    2.5.1    [dl] <span style="color: #555555;">(84.98 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">RColorBrewer</span>          1.1-3    [dl] <span style="color: #555555;">(54.47 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">Rcpp</span>                  1.0.13-1 [cmp][dl] <span style="color: #555555;">(2.90 MB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">rLakeAnalyzer</span>         1.11.4.1 [dl] <span style="color: #555555;">(605.05 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">rlang</span>                 1.1.4    [cmp][dl] <span style="color: #555555;">(1.62 MB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">s2</span>                    1.1.7    [cmp][dl] <span style="color: #555555;">(4.09 MB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">scales</span>                1.3.0    [cmp][dl] <span style="color: #555555;">(714.75 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">sf</span>                    1.0-19   [cmp][dl] <span style="color: #555555;">(40.98 MB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">stringi</span>               1.8.4    [cmp][dl] <span style="color: #555555;">(15.03 MB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">stringr</span>               1.5.1    [dl] <span style="color: #555555;">(323.42 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">tibble</span>                3.2.1    [cmp][dl] <span style="color: #555555;">(695.05 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">tidyr</span>                 1.3.1    [cmp][dl] <span style="color: #555555;">(1.27 MB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">tidyselect</span>            1.2.1    [cmp][dl] <span style="color: #555555;">(228.15 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">timechange</span>            0.3.0    [cmp][dl] <span style="color: #555555;">(514.48 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">units</span>                 0.8-5    [cmp][dl] <span style="color: #555555;">(784.55 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">utf8</span>                  1.2.4    [cmp][dl] <span style="color: #555555;">(150.80 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">vctrs</span>                 0.6.5    [cmp][dl] <span style="color: #555555;">(1.36 MB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">viridisLite</span>           0.4.2    [dl] <span style="color: #555555;">(1.30 MB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">withr</span>                 3.0.2    [dl] <span style="color: #555555;">(231.37 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">wk</span>                    0.9.4    [cmp][dl] <span style="color: #555555;">(2.05 MB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">yaml</span>                  2.3.10   [cmp][dl] <span style="color: #555555;">(119.45 kB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">+ </span><span style="color: #0000BB;">zoo</span>                   1.8-12   [cmp][dl] <span style="color: #555555;">(1.03 MB)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Getting 49 pkgs (119.38 MB), 1 cached</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">cli</span> 3.6.3 (i386+x86_64-w64-mingw32) (1.36 MB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">DBI</span> 1.2.3 (i386+x86_64-w64-mingw32) (941.47 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">dplyr</span> 1.1.4 (i386+x86_64-w64-mingw32) (1.59 MB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">e1071</span> 1.7-16 (i386+x86_64-w64-mingw32) (672.44 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">magrittr</span> 2.0.3 (i386+x86_64-w64-mingw32) (229.11 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">munsell</span> 0.5.1 (i386+x86_64-w64-mingw32) (246.01 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">plyr</span> 1.8.9 (i386+x86_64-w64-mingw32) (1.11 MB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">classInt</span> 0.4-10 (i386+x86_64-w64-mingw32) (504.95 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">colorspace</span> 2.1-1 (i386+x86_64-w64-mingw32) (2.67 MB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">psychrolib</span> 2.5.2 (i386+x86_64-w64-mingw32) (487.46 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">Rcpp</span> 1.0.13-1 (i386+x86_64-w64-mingw32) (2.88 MB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">rLakeAnalyzer</span> 1.11.4.1 (i386+x86_64-w64-mingw32) (606.16 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">rlang</span> 1.1.4 (i386+x86_64-w64-mingw32) (1.62 MB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">yaml</span> 2.3.10 (i386+x86_64-w64-mingw32) (117.04 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">stringr</span> 1.5.1 (i386+x86_64-w64-mingw32) (324.14 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">tibble</span> 3.2.1 (i386+x86_64-w64-mingw32) (695.40 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">tidyr</span> 1.3.1 (i386+x86_64-w64-mingw32) (1.27 MB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">pillar</span> 1.9.0 (i386+x86_64-w64-mingw32) (663.49 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">pkgconfig</span> 2.0.3 (i386+x86_64-w64-mingw32) (23.00 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">lubridate</span> 1.9.3 (i386+x86_64-w64-mingw32) (989.98 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">patchwork</span> 1.3.0 (i386+x86_64-w64-mingw32) (3.35 MB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">isoband</span> 0.2.7 (i386+x86_64-w64-mingw32) (1.93 MB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">gtable</span> 0.3.6 (i386+x86_64-w64-mingw32) (250.32 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">ncdf4</span> 1.23 (i386+x86_64-w64-mingw32) (7.28 MB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">vctrs</span> 0.6.5 (i386+x86_64-w64-mingw32) (1.34 MB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">viridisLite</span> 0.4.2 (i386+x86_64-w64-mingw32) (1.30 MB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">withr</span> 3.0.2 (i386+x86_64-w64-mingw32) (232.10 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">lifecycle</span> 1.0.4 (i386+x86_64-w64-mingw32) (141.91 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">proxy</span> 0.4-27 (i386+x86_64-w64-mingw32) (180.54 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">zoo</span> 1.8-12 (i386+x86_64-w64-mingw32) (1.03 MB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">fansi</span> 1.0.6 (i386+x86_64-w64-mingw32) (320.43 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">utf8</span> 1.2.4 (i386+x86_64-w64-mingw32) (149.20 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">purrr</span> 1.0.2 (i386+x86_64-w64-mingw32) (510.98 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">R6</span> 2.5.1 (i386+x86_64-w64-mingw32) (85.25 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">RColorBrewer</span> 1.1-3 (i386+x86_64-w64-mingw32) (54.57 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">timechange</span> 0.3.0 (i386+x86_64-w64-mingw32) (507.15 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">units</span> 0.8-5 (i386+x86_64-w64-mingw32) (783.33 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">wk</span> 0.9.4 (i386+x86_64-w64-mingw32) (2.04 MB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">glue</span> 1.8.0 (i386+x86_64-w64-mingw32) (183.12 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">tidyselect</span> 1.2.1 (i386+x86_64-w64-mingw32) (229.99 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">AEME</span> 0.1.0 (source) (27.95 MB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">stringi</span> 1.8.4 (i386+x86_64-w64-mingw32) (15.01 MB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">labeling</span> 0.4.3 (i386+x86_64-w64-mingw32) (63.85 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">farver</span> 2.1.2 (i386+x86_64-w64-mingw32) (1.51 MB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">generics</span> 0.1.3 (i386+x86_64-w64-mingw32) (83.89 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">scales</span> 1.3.0 (i386+x86_64-w64-mingw32) (721.01 kB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">ggplot2</span> 3.5.1 (i386+x86_64-w64-mingw32) (5.02 MB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">s2</span> 1.1.7 (i386+x86_64-w64-mingw32) (4.07 MB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">lwgeom</span> 0.2-14 (i386+x86_64-w64-mingw32) (10.95 MB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Got <span style="color: #0000BB;">sf</span> 1.0-19 (i386+x86_64-w64-mingw32) (40.08 MB)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">classInt</span> 0.4-10  <span style="color: #9E9E9E;">(133ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">DBI</span> 1.2.3  <span style="color: #9E9E9E;">(204ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">cli</span> 3.6.3  <span style="color: #9E9E9E;">(309ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">dplyr</span> 1.1.4  <span style="color: #9E9E9E;">(266ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">colorspace</span> 2.1-1  <span style="color: #9E9E9E;">(425ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">e1071</span> 1.7-16  <span style="color: #9E9E9E;">(230ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">fansi</span> 1.0.6  <span style="color: #9E9E9E;">(216ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">farver</span> 2.1.2  <span style="color: #9E9E9E;">(231ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">generics</span> 0.1.3  <span style="color: #9E9E9E;">(234ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">ggplot2</span> 3.5.1  <span style="color: #9E9E9E;">(326ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">glue</span> 1.8.0  <span style="color: #9E9E9E;">(318ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">gtable</span> 0.3.6  <span style="color: #9E9E9E;">(293ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">isoband</span> 0.2.7  <span style="color: #9E9E9E;">(209ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">labeling</span> 0.4.3  <span style="color: #9E9E9E;">(302ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">lifecycle</span> 1.0.4  <span style="color: #9E9E9E;">(310ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">lubridate</span> 1.9.3  <span style="color: #9E9E9E;">(340ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">magrittr</span> 2.0.3  <span style="color: #9E9E9E;">(206ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">munsell</span> 0.5.1  <span style="color: #9E9E9E;">(199ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">ncdf4</span> 1.23  <span style="color: #9E9E9E;">(230ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">patchwork</span> 1.3.0  <span style="color: #9E9E9E;">(235ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">pillar</span> 1.9.0  <span style="color: #9E9E9E;">(217ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">lwgeom</span> 0.2-14  <span style="color: #9E9E9E;">(733ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">pkgconfig</span> 2.0.3  <span style="color: #9E9E9E;">(221ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">plyr</span> 1.8.9  <span style="color: #9E9E9E;">(205ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">proxy</span> 0.4-27  <span style="color: #9E9E9E;">(217ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">psychrolib</span> 2.5.2  <span style="color: #9E9E9E;">(263ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">purrr</span> 1.0.2  <span style="color: #9E9E9E;">(267ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">R6</span> 2.5.1  <span style="color: #9E9E9E;">(278ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">RColorBrewer</span> 1.1-3  <span style="color: #9E9E9E;">(247ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">rLakeAnalyzer</span> 1.11.4.1  <span style="color: #9E9E9E;">(193ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">rlang</span> 1.1.4  <span style="color: #9E9E9E;">(218ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">s2</span> 1.1.7  <span style="color: #9E9E9E;">(374ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">scales</span> 1.3.0  <span style="color: #9E9E9E;">(380ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">stringr</span> 1.5.1  <span style="color: #9E9E9E;">(173ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">stringi</span> 1.8.4  <span style="color: #9E9E9E;">(375ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">tibble</span> 3.2.1  <span style="color: #9E9E9E;">(188ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">tidyr</span> 1.3.1  <span style="color: #9E9E9E;">(194ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">tidyselect</span> 1.2.1  <span style="color: #9E9E9E;">(169ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">Rcpp</span> 1.0.13-1  <span style="color: #9E9E9E;">(1.4s)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">timechange</span> 0.3.0  <span style="color: #9E9E9E;">(203ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">units</span> 0.8-5  <span style="color: #9E9E9E;">(203ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">utf8</span> 1.2.4  <span style="color: #9E9E9E;">(241ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">vctrs</span> 0.6.5  <span style="color: #9E9E9E;">(243ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">viridisLite</span> 0.4.2  <span style="color: #9E9E9E;">(189ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">withr</span> 3.0.2  <span style="color: #9E9E9E;">(303ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">sf</span> 1.0-19  <span style="color: #9E9E9E;">(2s)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">wk</span> 0.9.4  <span style="color: #9E9E9E;">(640ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">yaml</span> 2.3.10  <span style="color: #9E9E9E;">(502ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">zoo</span> 1.8-12  <span style="color: #9E9E9E;">(482ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Packaging <span style="color: #0000BB;">AEME</span> 0.1.0</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Packaged <span style="color: #0000BB;">AEME</span> 0.1.0 <span style="color: #9E9E9E;">(33.6s)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Building <span style="color: #0000BB;">AEME</span> 0.1.0</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Built <span style="color: #0000BB;">AEME</span> 0.1.0 <span style="color: #9E9E9E;">(15.6s)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Installed <span style="color: #0000BB;">AEME</span> 0.1.0 (github::limnotrack/AEME@147a74a) <span style="color: #9E9E9E;">(455ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> 1 pkg + 56 deps: kept 7, upd 1, added 49, dld 50 (NA B) <span style="color: #B2B2B2;">[1m 10.1s]</span></span></span></code></pre>
<p>Once installed, load the <code>AEME</code> package.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://limnotrack.github.io/AEME/">AEME</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'AEME'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     time</span></span></code></pre></div>
<p>Now, we will load the AEME object for Lake Rotorua (LID11133).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aeme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"lernzmp/LID11133.rds"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">aeme</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Aeme"</span></span>
<span><span class="co">#&gt; attr(,"package")</span></span>
<span><span class="co">#&gt; [1] "AEME"</span></span></code></pre></div>
<p>It can be printed to the console to see the contents of the
object.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aeme</span></span>
<span><span class="co">#&gt;             AEME </span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Lake</span></span>
<span><span class="co">#&gt; Rotorua (ID: LID11133); Lat: -38.09; Lon: 176.27; Elev: 284.88m; Depth: 48.15m;</span></span>
<span><span class="co">#&gt; Area: 80659960 m2; Shape file: Absent</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Time</span></span>
<span><span class="co">#&gt; Start: 2013-07-01; Stop: 2023-06-30; Time step: 3600</span></span>
<span><span class="co">#&gt;  Spin up (days): GLM: 1095; GOTM: 1095; DYRESM: 1095</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Configuration</span></span>
<span><span class="co">#&gt;     Model controls: Present</span></span>
<span><span class="co">#&gt;           Physical   |   Biogeochemical</span></span>
<span><span class="co">#&gt; DY-CD    : Absent     |   Absent </span></span>
<span><span class="co">#&gt; GLM-AED  : Present    |   Present</span></span>
<span><span class="co">#&gt; GOTM-WET : Present    |   Present</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Observations</span></span>
<span><span class="co">#&gt; Lake: Present; Level: Absent</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Input</span></span>
<span><span class="co">#&gt; Inital profile: Present; Inital depth: 48.148m; Hypsograph: Present (n=95);</span></span>
<span><span class="co">#&gt; Meteo: Present; Use longwave: TRUE; Kw: 0.5666667</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Inflows</span></span>
<span><span class="co">#&gt; Data: Present; Scaling factors: DY-CD: 1; GLM-AED: 1; GOTM-WET: 1</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Outflows</span></span>
<span><span class="co">#&gt; Data: Present; Scaling factors: DY-CD: 1; GLM-AED: 1; GOTM-WET: 1</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Water balance</span></span>
<span><span class="co">#&gt; Method: 2; Use: obs; Modelled: Absent; Water balance: Present</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Parameters: </span></span>
<span><span class="co">#&gt; Number of parameters: 18</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Output: </span></span>
<span><span class="co">#&gt; Number of ensembles: 1</span></span>
<span><span class="co">#&gt; DY-CD:    1</span></span>
<span><span class="co">#&gt; GLM-AED:  1</span></span>
<span><span class="co">#&gt; GOTM-WET: 1</span></span></code></pre></div>
<p>This allows for quick inspection of all the different slots within
the <code>Aeme</code> object. The lake section has the lake metadata,
the time section has the start, stop and spin-up dates, the
configuration section has the model configuration which allows for the
building of the AEME models locally.</p>
<pre><code><span><span class="co">#&gt; Building simulation for Rotorua [2024-11-14 10:34:20]</span></span>
<span><span class="co">#&gt; Building existing configuration for Rotorua [2024-11-14 10:34:20]</span></span>
<span><span class="co">#&gt; Missing state variables in inflows: CHM_oxy, NIT_don, NIT_pon, CAR_doc, CAR_poc, SIL_rsi, PHY_cyano, PHY_green, PHY_diatom, NCS_ss1</span></span>
<span><span class="co">#&gt; Added default values for missing variables.</span></span>
<span><span class="co">#&gt; Missing state variables in inflows: CHM_oxy, NIT_don, NIT_pon, CAR_doc, CAR_poc, SIL_rsi, PHY_cyano, PHY_green, PHY_diatom, NCS_ss1</span></span>
<span><span class="co">#&gt; Added default values for missing variables.</span></span>
<span><span class="co">#&gt; Missing state variables in inflows: CHM_oxy, NIT_don, NIT_pon, CAR_doc, CAR_poc, SIL_rsi, PHY_cyano, PHY_green, PHY_diatom, NCS_ss1</span></span>
<span><span class="co">#&gt; Added default values for missing variables.</span></span>
<span><span class="co">#&gt; Missing state variables in inflows: CHM_oxy, NIT_don, NIT_pon, CAR_doc, CAR_poc, SIL_rsi, PHY_cyano, PHY_green, PHY_diatom, NCS_ss1</span></span>
<span><span class="co">#&gt; Added default values for missing variables.</span></span>
<span><span class="co">#&gt; Missing state variables in inflows: CHM_oxy, NIT_don, NIT_pon, CAR_doc, CAR_poc, SIL_rsi, PHY_cyano, PHY_green, PHY_diatom, NCS_ss1</span></span>
<span><span class="co">#&gt; Added default values for missing variables.</span></span>
<span><span class="co">#&gt; Missing state variables in inflows: CHM_oxy, NIT_don, NIT_pon, CAR_doc, CAR_poc, SIL_rsi, PHY_cyano, PHY_green, PHY_diatom, NCS_ss1</span></span>
<span><span class="co">#&gt; Added default values for missing variables.</span></span>
<span><span class="co">#&gt; Missing state variables in inflows: CHM_oxy, NIT_pon, CAR_doc, CAR_poc, SIL_rsi, PHY_cyano, PHY_green, PHY_diatom, NCS_ss1</span></span>
<span><span class="co">#&gt; Added default values for missing variables.</span></span>
<span><span class="co">#&gt; No water level present. Using constant water level.</span></span>
<span><span class="co">#&gt; Correcting water balance using estimated outflows (method = 2).</span></span>
<span><span class="co">#&gt; Calculating lake level using lake depth and a sinisoidal function.</span></span>
<span><span class="co">#&gt; Warning in dir.create(lake_dir, showWarnings = TRUE): 'aeme\LID11133_rotorua'</span></span>
<span><span class="co">#&gt; already exists</span></span>
<span><span class="co">#&gt; Building GLM3-AED2 model for lake rotorua</span></span>
<span><span class="co">#&gt; Copied in AED nml file</span></span>
<span><span class="co">#&gt;    oxy_initial = 312.5 replaced with 312.5</span></span>
<span><span class="co">#&gt;    frp_initial = 0.1614 replaced with 0.1614</span></span>
<span><span class="co">#&gt;    dop_initial = 0.3229 replaced with 0.3229</span></span>
<span><span class="co">#&gt;    pop_initial = 0.3229 replaced with 0.3229</span></span>
<span><span class="co">#&gt;    amm_initial = 1.1423 replaced with 1.1423</span></span>
<span><span class="co">#&gt;    nit_initial = 0.4284 replaced with 0.4284</span></span>
<span><span class="co">#&gt;    don_initial = 21.4183 replaced with 21.4183</span></span>
<span><span class="co">#&gt;    pon_initial = 7.1394 replaced with 7.1394</span></span>
<span><span class="co">#&gt;    doc_initial = 41.6285 replaced with 41.6285</span></span>
<span><span class="co">#&gt;    poc_initial = 16.6514 replaced with 16.6514</span></span>
<span><span class="co">#&gt;    rsi_initial = 1 replaced with 1</span></span>
<span><span class="co">#&gt; PHY_cyano 0.24022 replaced with 0.24022</span></span>
<span><span class="co">#&gt; PHY_green 0.300275 replaced with 0.300275</span></span>
<span><span class="co">#&gt; PHY_diatom 0.300275 replaced with 0.300275</span></span>
<span><span class="co">#&gt;    ss_initial = 3 replaced with 3,</span></span>
<span><span class="co">#&gt; Building GOTM-WET for lake rotorua</span></span>
<span><span class="co">#&gt; instances/abiotic_water/initialization/sO2W 10 replaced with 10</span></span>
<span><span class="co">#&gt; instances/abiotic_water/initialization/sPO4W 0.005 replaced with 0.005</span></span>
<span><span class="co">#&gt; instances/abiotic_water/initialization/sPDOMW 0.01 replaced with 0.01</span></span>
<span><span class="co">#&gt; instances/abiotic_water/initialization/sPPOMW 0.01 replaced with 0.01</span></span>
<span><span class="co">#&gt; instances/abiotic_water/initialization/sNH4W 0.016 replaced with 0.016</span></span>
<span><span class="co">#&gt; instances/abiotic_water/initialization/sNO3W 0.006 replaced with 0.006</span></span>
<span><span class="co">#&gt; instances/abiotic_water/initialization/sNDOMW 0.3 replaced with 0.3</span></span>
<span><span class="co">#&gt; instances/abiotic_water/initialization/sNPOMW 0.1 replaced with 0.1</span></span>
<span><span class="co">#&gt; instances/abiotic_water/initialization/sDDOMW 0.5 replaced with 0.5</span></span>
<span><span class="co">#&gt; instances/abiotic_water/initialization/sDPOMW 0.2 replaced with 0.2</span></span>
<span><span class="co">#&gt; instances/abiotic_water/initialization/sSiO2W 1 replaced with 1</span></span>
<span><span class="co">#&gt; instances/cyanobacteria/initialization/sDW 0.2 replaced with 0.2</span></span>
<span><span class="co">#&gt; instances/cyanobacteria/initialization/sNW 0.03 replaced with 0.03</span></span>
<span><span class="co">#&gt; instances/cyanobacteria/initialization/sPW 0.0019 replaced with 0.0019</span></span>
<span><span class="co">#&gt; instances/greens/initialization/sDW 0.1 replaced with 0.1</span></span>
<span><span class="co">#&gt; instances/greens/initialization/sNW 0.015 replaced with 0.015</span></span>
<span><span class="co">#&gt; instances/greens/initialization/sPW 0.00094 replaced with 0.00094</span></span>
<span><span class="co">#&gt; instances/diatoms/initialization/sDW 0.25 replaced with 0.25</span></span>
<span><span class="co">#&gt; instances/diatoms/initialization/sNW 0.038 replaced with 0.038</span></span>
<span><span class="co">#&gt; instances/diatoms/initialization/sPW 0.0024 replaced with 0.0024</span></span>
<span><span class="co">#&gt; instances/abiotic_water/initialization/sDIMW 3 replaced with 3</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">"aeme"</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "LID11133_rotorua/glm_aed/aed2/aed2.nml"                  </span></span>
<span><span class="co">#&gt;  [2] "LID11133_rotorua/glm_aed/aed2/aed2_phyto_pars.nml"       </span></span>
<span><span class="co">#&gt;  [3] "LID11133_rotorua/glm_aed/aed2/aed2_zoop_pars.nml"        </span></span>
<span><span class="co">#&gt;  [4] "LID11133_rotorua/glm_aed/bcs/inflow_lumped.csv"          </span></span>
<span><span class="co">#&gt;  [5] "LID11133_rotorua/glm_aed/bcs/inflow_NZS4081641.csv"      </span></span>
<span><span class="co">#&gt;  [6] "LID11133_rotorua/glm_aed/bcs/inflow_NZS4083363.csv"      </span></span>
<span><span class="co">#&gt;  [7] "LID11133_rotorua/glm_aed/bcs/inflow_NZS4084132.csv"      </span></span>
<span><span class="co">#&gt;  [8] "LID11133_rotorua/glm_aed/bcs/inflow_NZS4084816.csv"      </span></span>
<span><span class="co">#&gt;  [9] "LID11133_rotorua/glm_aed/bcs/inflow_NZS4086165.csv"      </span></span>
<span><span class="co">#&gt; [10] "LID11133_rotorua/glm_aed/bcs/inflow_precip.csv"          </span></span>
<span><span class="co">#&gt; [11] "LID11133_rotorua/glm_aed/bcs/meteo_glm.csv"              </span></span>
<span><span class="co">#&gt; [12] "LID11133_rotorua/glm_aed/bcs/outflow_wbal.csv"           </span></span>
<span><span class="co">#&gt; [13] "LID11133_rotorua/glm_aed/glm3.nml"                       </span></span>
<span><span class="co">#&gt; [14] "LID11133_rotorua/gotm_wet/fabm.yaml"                     </span></span>
<span><span class="co">#&gt; [15] "LID11133_rotorua/gotm_wet/gotm.yaml"                     </span></span>
<span><span class="co">#&gt; [16] "LID11133_rotorua/gotm_wet/inputs/hypsograph.dat"         </span></span>
<span><span class="co">#&gt; [17] "LID11133_rotorua/gotm_wet/inputs/inf_chem_lumped.dat"    </span></span>
<span><span class="co">#&gt; [18] "LID11133_rotorua/gotm_wet/inputs/inf_chem_NZS4081641.dat"</span></span>
<span><span class="co">#&gt; [19] "LID11133_rotorua/gotm_wet/inputs/inf_chem_NZS4083363.dat"</span></span>
<span><span class="co">#&gt; [20] "LID11133_rotorua/gotm_wet/inputs/inf_chem_NZS4084132.dat"</span></span>
<span><span class="co">#&gt; [21] "LID11133_rotorua/gotm_wet/inputs/inf_chem_NZS4084816.dat"</span></span>
<span><span class="co">#&gt; [22] "LID11133_rotorua/gotm_wet/inputs/inf_chem_NZS4086165.dat"</span></span>
<span><span class="co">#&gt; [23] "LID11133_rotorua/gotm_wet/inputs/inf_chem_precip.dat"    </span></span>
<span><span class="co">#&gt; [24] "LID11133_rotorua/gotm_wet/inputs/inf_flow_lumped.dat"    </span></span>
<span><span class="co">#&gt; [25] "LID11133_rotorua/gotm_wet/inputs/inf_flow_NZS4081641.dat"</span></span>
<span><span class="co">#&gt; [26] "LID11133_rotorua/gotm_wet/inputs/inf_flow_NZS4083363.dat"</span></span>
<span><span class="co">#&gt; [27] "LID11133_rotorua/gotm_wet/inputs/inf_flow_NZS4084132.dat"</span></span>
<span><span class="co">#&gt; [28] "LID11133_rotorua/gotm_wet/inputs/inf_flow_NZS4084816.dat"</span></span>
<span><span class="co">#&gt; [29] "LID11133_rotorua/gotm_wet/inputs/inf_flow_NZS4086165.dat"</span></span>
<span><span class="co">#&gt; [30] "LID11133_rotorua/gotm_wet/inputs/inf_flow_precip.dat"    </span></span>
<span><span class="co">#&gt; [31] "LID11133_rotorua/gotm_wet/inputs/inf_salt_lumped.dat"    </span></span>
<span><span class="co">#&gt; [32] "LID11133_rotorua/gotm_wet/inputs/inf_salt_NZS4081641.dat"</span></span>
<span><span class="co">#&gt; [33] "LID11133_rotorua/gotm_wet/inputs/inf_salt_NZS4083363.dat"</span></span>
<span><span class="co">#&gt; [34] "LID11133_rotorua/gotm_wet/inputs/inf_salt_NZS4084132.dat"</span></span>
<span><span class="co">#&gt; [35] "LID11133_rotorua/gotm_wet/inputs/inf_salt_NZS4084816.dat"</span></span>
<span><span class="co">#&gt; [36] "LID11133_rotorua/gotm_wet/inputs/inf_salt_NZS4086165.dat"</span></span>
<span><span class="co">#&gt; [37] "LID11133_rotorua/gotm_wet/inputs/inf_salt_precip.dat"    </span></span>
<span><span class="co">#&gt; [38] "LID11133_rotorua/gotm_wet/inputs/inf_temp_lumped.dat"    </span></span>
<span><span class="co">#&gt; [39] "LID11133_rotorua/gotm_wet/inputs/inf_temp_NZS4081641.dat"</span></span>
<span><span class="co">#&gt; [40] "LID11133_rotorua/gotm_wet/inputs/inf_temp_NZS4083363.dat"</span></span>
<span><span class="co">#&gt; [41] "LID11133_rotorua/gotm_wet/inputs/inf_temp_NZS4084132.dat"</span></span>
<span><span class="co">#&gt; [42] "LID11133_rotorua/gotm_wet/inputs/inf_temp_NZS4084816.dat"</span></span>
<span><span class="co">#&gt; [43] "LID11133_rotorua/gotm_wet/inputs/inf_temp_NZS4086165.dat"</span></span>
<span><span class="co">#&gt; [44] "LID11133_rotorua/gotm_wet/inputs/inf_temp_precip.dat"    </span></span>
<span><span class="co">#&gt; [45] "LID11133_rotorua/gotm_wet/inputs/lyrs.dat"               </span></span>
<span><span class="co">#&gt; [46] "LID11133_rotorua/gotm_wet/inputs/meteo.dat"              </span></span>
<span><span class="co">#&gt; [47] "LID11133_rotorua/gotm_wet/inputs/meteo_swr.dat"          </span></span>
<span><span class="co">#&gt; [48] "LID11133_rotorua/gotm_wet/inputs/outf_wbal.dat"          </span></span>
<span><span class="co">#&gt; [49] "LID11133_rotorua/gotm_wet/inputs/s_prof_file.dat"        </span></span>
<span><span class="co">#&gt; [50] "LID11133_rotorua/gotm_wet/inputs/t_prof_file.dat"        </span></span>
<span><span class="co">#&gt; [51] "LID11133_rotorua/gotm_wet/output.yaml"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="run-aeme-models">Run AEME models<a class="anchor" aria-label="anchor" href="#run-aeme-models"></a>
</h2>
<p>We will now run the AEME models for the two lakes. This will run the
models with the configurations built in the <code>path</code> directory.
The <code>parallel</code> argument is set to <code>TRUE</code> to run
the models in parallel which can speed up the process.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aeme</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_aeme.html">run_aeme</a></span><span class="op">(</span>aeme <span class="op">=</span> <span class="va">aeme</span>, model <span class="op">=</span> <span class="va">model</span>, path <span class="op">=</span> <span class="va">path</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Running models in parallel... [2024-11-14 10:34:57]</span></span>
<span><span class="co">#&gt; Model run complete![2024-11-14 10:36:36]</span></span>
<span><span class="co">#&gt; Reading models in parallel... [2024-11-14 10:36:36]</span></span>
<span><span class="co">#&gt; Model reading complete![2024-11-14 10:37:07]</span></span>
<span><span class="va">aeme</span></span>
<span><span class="co">#&gt;             AEME </span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Lake</span></span>
<span><span class="co">#&gt; Rotorua (ID: LID11133); Lat: -38.09; Lon: 176.27; Elev: 284.88m; Depth: 48.15m;</span></span>
<span><span class="co">#&gt; Area: 80659960 m2; Shape file: Absent</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Time</span></span>
<span><span class="co">#&gt; Start: 2013-07-01; Stop: 2023-06-30; Time step: 3600</span></span>
<span><span class="co">#&gt;  Spin up (days): GLM: 1095; GOTM: 1095; DYRESM: 1095</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Configuration</span></span>
<span><span class="co">#&gt;     Model controls: Present</span></span>
<span><span class="co">#&gt;           Physical   |   Biogeochemical</span></span>
<span><span class="co">#&gt; DY-CD    : Absent     |   Absent </span></span>
<span><span class="co">#&gt; GLM-AED  : Present    |   Present</span></span>
<span><span class="co">#&gt; GOTM-WET : Present    |   Present</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Observations</span></span>
<span><span class="co">#&gt; Lake: Present; Level: Absent</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Input</span></span>
<span><span class="co">#&gt; Inital profile: Present; Inital depth: 48.148m; Hypsograph: Present (n=95);</span></span>
<span><span class="co">#&gt; Meteo: Present; Use longwave: TRUE; Kw: 0.5666667</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Inflows</span></span>
<span><span class="co">#&gt; Data: Present; Scaling factors: DY-CD: 1; GLM-AED: 1; GOTM-WET: 1</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Outflows</span></span>
<span><span class="co">#&gt; Data: Present; Scaling factors: DY-CD: 1; GLM-AED: 1; GOTM-WET: 1</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Water balance</span></span>
<span><span class="co">#&gt; Method: 2; Use: obs; Modelled: Absent; Water balance: Present</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Parameters: </span></span>
<span><span class="co">#&gt; Number of parameters: 18</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Output: </span></span>
<span><span class="co">#&gt; Number of ensembles: 1</span></span>
<span><span class="co">#&gt; DY-CD:    0</span></span>
<span><span class="co">#&gt; GLM-AED:  1</span></span>
<span><span class="co">#&gt; GOTM-WET: 1</span></span></code></pre></div>
<p>In the “Output” section of the <code>Aeme</code> object, the “Number
of ensembles” is set to 1 indicating that there is now output for each
model in the <code>Aeme</code> object.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_output.html">plot_output</a></span><span class="op">(</span>aeme <span class="op">=</span> <span class="va">aeme</span>, model <span class="op">=</span> <span class="va">model</span>, var_sim <span class="op">=</span> <span class="st">"HYD_temp"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 332 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_col()`).</span></span></code></pre></div>
<p><img src="lernzmp-aeme_files/figure-html/lernzmp-plot-temperature-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_output.html">plot_output</a></span><span class="op">(</span>aeme <span class="op">=</span> <span class="va">aeme</span>, model <span class="op">=</span> <span class="va">model</span>, var_sim <span class="op">=</span> <span class="st">"CHM_oxy"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 332 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_col()`).</span></span></code></pre></div>
<p><img src="lernzmp-aeme_files/figure-html/lernzmp-plot-oxygen-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tadhg Moore.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
