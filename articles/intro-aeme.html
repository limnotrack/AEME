<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to AEME • AEME</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to AEME">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">AEME</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/aeme-inputs.html">AEME Inputs</a></li>
    <li><a class="dropdown-item" href="../articles/intro-aeme.html">Introduction to AEME</a></li>
    <li><a class="dropdown-item" href="../articles/lernzmp-aeme.html">Using LERNZmp with AEME</a></li>
    <li><a class="dropdown-item" href="../articles/setup-new-lake.html">Set up AEME for a new lake</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-contributing" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Contributing</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-contributing">
<li><a class="dropdown-item" href="../CONTRIBUTING.html">Contributing</a></li>
    <li><a class="dropdown-item" href="../CODE_OF_CONDUCT.html">Code of conduct</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/limnotrack/AEME/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to AEME</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/limnotrack/AEME/blob/main/vignettes/intro-aeme.Rmd" class="external-link"><code>vignettes/intro-aeme.Rmd</code></a></small>
      <div class="d-none name"><code>intro-aeme.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>The AEME package hosts three one-dimensional hydrodynamic models: the
DYnamic REservoir Simulation Model (DYRESM), the General Lake Model
(GLM), and the General Ocean Turbulence Model (GOTM, which has been
adapted for closed basins for application to lakes and reservoirs). The
models can be coupled to their corresponding water quality models, the
DYRESM-CAEDYM (Computational Aquatic Ecosystem Dynamics Model), GLM-AED2
(Aquatic Ecosystem Dynamics Model 2), and GOTM-WET (Water Ecosystem
Tool).</p>
<p>Key aspects of the AEME package include:</p>
<ul>
<li><p>Defined S4 class for <code>aeme</code> objects</p></li>
<li><p>Configuration of models from common and standardised
inputs</p></li>
<li><p>Standardised calibration, manipulation and visualisation</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="sec-aeme-object">AEME object<a class="anchor" aria-label="anchor" href="#sec-aeme-object"></a>
</h2>
<div class="section level3">
<h3 id="sec-description">Description<a class="anchor" aria-label="anchor" href="#sec-description"></a>
</h3>
<p>The <code>aeme</code> object is the main object in the AEME package.
It is an S4 class that contains all the information required to run a
model. The <code>aeme</code> object contains the following slots:</p>
<ul>
<li>
<a href="#sec-lake"><strong>lake</strong></a> - a list object
containing information about the lake (name, id, latitude, longitude,
elevation, depth, area)</li>
<li>
<a href="#sec-time"><strong>time</strong></a> - a list object
containing information about the time (start, stop, spin_up,
time_step)</li>
<li>
<a href="#sec-configuration"><strong>configuration</strong></a> - a
list object containing information about the configuration
(model_controls, dy_cd, glm_aed, gotm_wet)</li>
<li>
<a href="#sec-observations"><strong>observations</strong></a> - a
list object containing information about the observations (lake,
level)</li>
<li>
<a href="#sec-inputs"><strong>inputs</strong></a> - a list object
containing information about the inputs (init_profile, init_depth,
hypsograph, meteo, use_lw, Kw)</li>
<li>
<a href="#sec-inflows"><strong>inflows</strong></a> - a list object
containing information about the inflows (data, factor)</li>
<li>
<a href="#sec-outflows"><strong>outflows</strong></a> - a list
object containing information about the outflows (data, outflow_lvl,
factor)</li>
<li>
<a href="#sec-water_balance"><strong>water_balance</strong></a> - a
list object containing information about the water balance configuration
(use, method, data)</li>
<li>
<a href="#sec-parameters"><strong>parameters</strong></a> - a
data.frame describing the parameters to be input with column names
(model, file, name, value, min, max, module, group)</li>
<li>
<a href="#sec-output"><strong>output</strong></a> - a list object
containing information about the outputs (n_members)</li>
</ul>
<div class="section level4">
<h4 id="sec-lake">Lake<a class="anchor" aria-label="anchor" href="#sec-lake"></a>
</h4>
<p>The <code>lake</code> slot contains information about the lake. It is
a list object that contains the following objects:</p>
<ul>
<li><p>name - Name of the lake (character).</p></li>
<li><p>id - Lake ID (character or numeric).</p></li>
<li><p><strong>latitude</strong> - Latitude of the lake (numeric). If
not provided, the latitude will be calculated from the centroid of the
shape.</p></li>
<li><p><strong>longitude</strong> - Longitude of the lake (numeric). If
not provided, the longitude will be calculated from the centroid of the
shape.</p></li>
<li><p><strong>elevation</strong> - Elevation of the lake
(numeric).</p></li>
<li><p>shape - Shape of the lake (sf object). The shape of the lake can
be represented as a polygon. The centroid of the polygon will be used to
calculate the latitude and longitude of the lake.</p></li>
<li><p><strong>depth</strong> - Max depth of the lake (m) (numeric).
Depth and area are used to generate a simple hypsographic curve if none
is provided in the <code>inputs</code> slot.</p></li>
<li><p><strong>area</strong> - Surface area of the lake (m2)
(numeric)</p></li>
</ul>
<p>Objects in <strong>bold</strong> are required for building and
running the model.</p>
</div>
<div class="section level4">
<h4 id="sec-time">Time<a class="anchor" aria-label="anchor" href="#sec-time"></a>
</h4>
<p>The <code>time</code> slot contains information about the time. It is
a list object that contains the following objects:</p>
<ul>
<li><p><strong>start</strong> - Start date of the simulation
(character). The start date must be in the format
<code>YYYY-MM-DD HH:MM:SS</code>.</p></li>
<li><p><strong>end</strong> - End date of the simulation (character).
The end date must be in the format
<code>YYYY-MM-DD HH:MM:SS</code>.</p></li>
<li><p><strong>timestep</strong> - Timestep of the simulation (numeric).
The timestep must be in seconds.</p></li>
<li><p><strong>spin_up</strong> - List of spin up periods of the
simulation for each model (numeric). The spin up period must be in days.
The spin up period is the period of time that the model is run before
the simulation period. The spin up period is used to initialise the
model which is then discarded when examining the simulation
period.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="sec-configuration">Configuration<a class="anchor" aria-label="anchor" href="#sec-configuration"></a>
</h4>
<p>The <code>configuration</code> slot is a list that contains each of
the model configurations. This includes the configurations files for the
hydrodynamic components as well as the aquatic ecosystem model
components:</p>
<table class="table">
<caption>Files for hydrodynamic and ecosystem models.</caption>
<colgroup>
<col width="25%">
<col width="33%">
<col width="41%">
</colgroup>
<thead><tr class="header">
<th>Model</th>
<th>Hyrodynamic</th>
<th>Ecosystem</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>DYRESM-CAEDYM</td>
<td>
<em>.cfg</em> file and <em>.par</em> file</td>
<td>
<em>.con</em>, <em>caedym3p1.bio, caedym3p1.chm</em> and
<em>caedym3p1.sed</em> files</td>
</tr>
<tr class="even">
<td>GLM-AED</td>
<td>
<em>glm3.nml</em> file</td>
<td>
<em>aed2.nml</em>, <em>phytos.nml</em>, <em>zoops.nml</em>
files</td>
</tr>
<tr class="odd">
<td>GOTM-WET</td>
<td>
<em>gotm.yaml</em> and <em>output.yaml</em> files</td>
<td>
<em>fabm.yaml</em> file</td>
</tr>
</tbody>
</table>
<p>When <code><a href="../reference/build_aeme.html">build_aeme()</a></code> is ran, the
<code>model_controls</code> data.frame that is passed to the function as
an argument is added to the <code>configuration</code> slot.</p>
<p>For more details on the <code>model_controls</code>, see it’s section
<a href="#sec-model_controls">below</a>.</p>
</div>
<div class="section level4">
<h4 id="sec-observations">Observations<a class="anchor" aria-label="anchor" href="#sec-observations"></a>
</h4>
<p>The <code>observations</code> slot is a list that contains
observations of in-lake (<code>lake</code>) variables (e.g. water
temperature, chlorophyll-a, dissolved oxygen etc.) and water level
(<code>level</code>). The observations are used to assess model
performance using the function and also to calibrate the model using the
<a href="https://github.com/limnotrack/aemetools" class="external-link">aemetools</a>
package.</p>
<p>The <code>lake</code> observations are stored in a data frame with
the following columns:</p>
<ul>
<li><p><strong>Date</strong> - Date of the observation (character). The
date must be in the format <code>YYYY-MM-DD HH:MM:SS</code>.</p></li>
<li><p><strong>depth</strong> - Depth of the observation (m) (numeric).
The depth must be in metres.</p></li>
<li><p><strong>var</strong> - Variable name of the observation
(character). The variable names an input preparation are designed in the
<a href="aeme-inputs.html">AEME inputs article</a>.</p></li>
<li><p><strong>value</strong> - Value of the observation
(numeric).</p></li>
</ul>
<p>The <code>level</code> observations are stored in a data frame with
the following columns:</p>
<ul>
<li><p><strong>Date</strong> - Date of the observation (character). The
date must be in the format <code>YYYY-MM-DD HH:MM:SS</code>.</p></li>
<li><p><strong>value</strong> - Value of the observation
(numeric).</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="sec-inputs">Input<a class="anchor" aria-label="anchor" href="#sec-inputs"></a>
</h4>
<p>The <code>input</code> slot is a list that contains the following
objects:</p>
<ul>
<li><p>init_profile - profile to initialise the lake simulation
(data.frame). It has the columns: “depth”, “temperature” and “salt”. If
this is not provided, it is automatically generated using the values in
the <a href="#sec-model_controls"><code>model_controls</code></a>.</p></li>
<li><p>init_depth - depth of the lake when initialising the model
(vector), If not provided, will assume the depth from the
<code>hypsograph</code>.</p></li>
<li><p><strong>hypsograph</strong> - the lake hypsograph. This is a
data.frame with the columns “elev”, “depth” and “area”. If you do not
have this data, you can generate one using the
<code><a href="../reference/generate_hypsograph.html">generate_hypsograph()</a></code> function.</p></li>
<li><p><strong>meteo</strong> - the meteorological data. A data.frame
which at a minimum must contain the columns date (“Date”), air
temperature (“MET_tmpair), wind speed (”MET_wndspd”) and shortwave
radiation (“MET_radswd”). See <a href="https://limnotrack.github.io/AEME/articles/aeme-inputs.html#meteorological-data" class="external-link">AEME
Inputs</a></p></li>
<li><p>use_lw - Logical switch to use longwave radiation. Defaults to
TRUE.</p></li>
<li><p><strong>Kw</strong> - the light extinction coefficient
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>m</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><annotation encoding="application/x-tex">m^{-1}</annotation></semantics></math>).</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="sec-inflows">Inflows<a class="anchor" aria-label="anchor" href="#sec-inflows"></a>
</h4>
<p>The inflows slot is a list that contains the following objects:</p>
<ul>
<li><p>data - named list of data.frames which contain the columns date
(“Date”), flow (“HYD_flow”;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>m</mi><mn>3</mn></msup><mi>d</mi><mi>a</mi><msup><mi>y</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">m^3 day^{-1}</annotation></semantics></math>).
Temperature can also be provided (“HYD_temp”), however if not provided
then it will be estimated using air temperature. The name for the list
will be used as the stream identifier in each model. If
<code>method</code> in the water_balance section is set
to<code>3</code>, then “wbal” will be added to the data, this contains a
separate inflow for each model, estimated using the different
evaporation functions inside each model.</p></li>
<li><p>factor - list of scaling factors to be applied to the inflows.
Named according to each model.</p></li>
</ul>
<p>If no inflows are present then this slot will be empty.</p>
</div>
<div class="section level4">
<h4 id="sec-outflows">Outflows<a class="anchor" aria-label="anchor" href="#sec-outflows"></a>
</h4>
<p>The outflows slot is a list that contains the following objects:</p>
<ul>
<li><p>data - named list of data.frames which contain the columns date
(“Date”), flow (“HYD_flow”;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>m</mi><mn>3</mn></msup><mi>d</mi><mi>a</mi><msup><mi>y</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">m^3 day^{-1}</annotation></semantics></math>).
If <code>method</code> in the water_balance section is set to
<code>2</code> or <code>3</code>, then “wbal” will be added to the data,
this contains a separate outflow for each model, estimated using the
different evaporation functions inside each model.</p></li>
<li><p>factor - list of scaling factors to be applied to the outflows.
Named according to each model. However, this can also be passed as a
parameter in the model_parameters section and calibrated there. This is
the preferred method for applying scaling factors.</p></li>
</ul>
<p>If no outflows are present then this slot will be empty.</p>
</div>
<div class="section level4">
<h4 id="sec-water_balance">Water balance<a class="anchor" aria-label="anchor" href="#sec-water_balance"></a>
</h4>
<p>The water balance slot is generated internally when the
<code><a href="../reference/build_aeme.html">build_aeme()</a></code> function is called and the
<code>wb_method</code> is set to <code>2</code> or <code>3</code>. The
slot contains:</p>
<ul>
<li><p>use: define which lake level to use. Can either be observed
(“obs”) or modelled (“mod”) lake level. Default = “obs”.</p></li>
<li><p>method: This can be <code>1</code> (no inflows or outflows) or
<code>2</code> (outflows calculated) or <code>3</code> (inflows and
outflows calculated). The default is <code>2</code> .</p></li>
<li><p>data: list of two data.frames. “wbal” which contains the
diagnostics for estimating evaporation and water balance for each model
and “model” which contains the modelled lake water level if
<code>use</code> is “mod”.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="sec-parameters">Parameters<a class="anchor" aria-label="anchor" href="#sec-parameters"></a>
</h4>
<p>The parameters slot contains a data.frame of parameters which are
used when building the model. These will update the default model
parameters or scale the meteorological or scale the inflows and outflows
for each model.</p>
<p>The columns for the parameters data.frame are:</p>
<ul>
<li><p>model - Either “dy_cd”, “glm_aed” and “gotm_wet”.</p></li>
<li><p>file - Either the name of the file e.g. “glm3.nml” for model
specific files or “met” for meteorological variables or “inf” for inflow
or “wdr” for outflows. (Outflows were initiallly referred to as
withdrawals, hence the “wdr” notation, this will probably be updated to
reflect the current outflows slot soon…).</p></li>
<li><p>name - Name of the parameter. If the name of the parameter is
nested in a nml/yaml file, then the whole hierarchy needs to be provide
with each level separated by a “/” e.g. “light/Kw” for Kw in
GLM-AED.</p></li>
<li><p>value - Value of the parameter.</p></li>
<li><p>min - Minimum range of the parameter. This is used in the
<code><a href="https://limnotrack.github.io/aemetools/reference/calib_aeme.html" class="external-link">aemetools::calib_aeme()</a></code> and
<code><a href="https://limnotrack.github.io/aemetools/reference/sa_aeme.html" class="external-link">aemetools::sa_aeme()</a></code> function.</p></li>
<li><p>max - Maximum range of the parameter. This is used in the
<code><a href="https://limnotrack.github.io/aemetools/reference/calib_aeme.html" class="external-link">aemetools::calib_aeme()</a></code> and
<code><a href="https://limnotrack.github.io/aemetools/reference/sa_aeme.html" class="external-link">aemetools::sa_aeme()</a></code> function.</p></li>
<li><p>module - Module that the parameter is in. Not necessary, but is
helpful for identifying which parameters are in which module for GLM-AED
and GOTM-WET.</p></li>
<li><p>group - Phytoplankton group. This is only used for GOTM-WET
phytoplankton parameters.</p></li>
</ul>
<p>There is a function <code><a href="../reference/get_aeme_parameters.html">get_aeme_parameters()</a></code> which allows
you to select parameters based on model and module. See
<code>?get_aeme_parameters()</code> for more details.</p>
</div>
<div class="section level4">
<h4 id="sec-output">Output<a class="anchor" aria-label="anchor" href="#sec-output"></a>
</h4>
<p>The output slot is a list that is updated when
<code><a href="../reference/run_aeme.html">run_aeme()</a></code> is executed. Each time it is executed, variable
outputs designated in the <code>model_controls</code> will be added to
the <code>Aeme</code> object.</p>
</div>
</div>
<div class="section level3">
<h3 id="sec-model_controls">Model controls<a class="anchor" aria-label="anchor" href="#sec-model_controls"></a>
</h3>
<p>The <code>model_controls</code> is a data.frame generated by the
<code><a href="../reference/get_model_controls.html">get_model_controls()</a></code>. The data.frame has the columns:</p>
<ul>
<li><p>var_aeme - character; the AEME variable name</p></li>
<li><p>simulate - logical; add the variable to the <code>Aeme</code>
object</p></li>
<li><p>inf_default - numeric; default value to use in the inflows if
none present in the inflows. This is particularly important for
configuring water chemistry for the inflows if
<code>use_bgc = TRUE</code>.</p></li>
<li><p>initial_wc - numeric; value to use in initialising the model.
This will be automatically updated if the variable is present in the
<code>observations</code> slot.</p></li>
<li><p>initial_sed - numeric; value to use in intialising the sediment
module for the DYRESM-CAEDYM model.</p></li>
<li><p>conversion_aed - numeric; factor to multiply by to convert to
GLM-AED units.</p></li>
</ul>
<p>When the model is built the mode</p>
</div>
<div class="section level3">
<h3 id="creation">Creation<a class="anchor" aria-label="anchor" href="#creation"></a>
</h3>
<p>The <code>aeme</code> object can be created using the
<code><a href="../reference/aeme_constructor.html">aeme_constructor()</a></code> function. It requires the basic inputs
to from a YAML file using the <code>yaml_to_aeme</code> function. The
YAML file contains all the information required to run the model.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define lake list</span></span>
<span><span class="va">lat</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">36.88921</span></span>
<span><span class="va">lon</span> <span class="op">&lt;-</span> <span class="fl">174.4669</span></span>
<span><span class="va">depth</span> <span class="op">&lt;-</span> <span class="fl">13.08</span></span>
<span><span class="va">area</span> <span class="op">&lt;-</span> <span class="fl">153648</span></span>
<span></span>
<span><span class="va">lake</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    latitude <span class="op">=</span> <span class="va">lat</span>,</span>
<span>    longitude <span class="op">=</span> <span class="va">lon</span>,</span>
<span>    <span class="co"># elevation = elevation,</span></span>
<span>    depth <span class="op">=</span> <span class="va">depth</span>,</span>
<span>    area <span class="op">=</span> <span class="va">area</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2020-07-01"</span><span class="op">)</span>,</span>
<span>  stop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2022-06-30"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">hypsograph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_hypsograph.html">generate_hypsograph</a></span><span class="op">(</span>max_depth <span class="op">=</span> <span class="va">depth</span>, surface_area <span class="op">=</span> <span class="va">area</span>,</span>
<span>                                  volume_development <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">met</span> <span class="op">&lt;-</span> <span class="fu">aemetools</span><span class="fu">::</span><span class="fu"><a href="https://limnotrack.github.io/aemetools/reference/get_era5_land_point_nz.html" class="external-link">get_era5_land_point_nz</a></span><span class="op">(</span>lat <span class="op">=</span> <span class="va">lat</span>, lon <span class="op">=</span> <span class="va">lon</span>,</span>
<span>                                         years <span class="op">=</span> <span class="fl">2020</span><span class="op">:</span><span class="fl">2022</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#' Define input list</span></span>
<span><span class="va">input</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  hypsograph <span class="op">=</span> <span class="va">hypsograph</span>,</span>
<span>  meteo <span class="op">=</span> <span class="va">met</span>,</span>
<span>  Kw <span class="op">=</span> <span class="fl">1.21</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">aeme</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aeme_constructor.html">aeme_constructor</a></span><span class="op">(</span>lake <span class="op">=</span> <span class="va">lake</span>, time <span class="op">=</span> <span class="va">time</span>, input <span class="op">=</span> <span class="va">input</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">slotNames</span><span class="op">(</span><span class="va">aeme</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "lake"          "time"          "configuration" "observations" </span></span>
<span><span class="co">#&gt;  [5] "input"         "inflows"       "outflows"      "water_balance"</span></span>
<span><span class="co">#&gt;  [9] "output"        "parameters"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="manipulation">Manipulation<a class="anchor" aria-label="anchor" href="#manipulation"></a>
</h2>
<p>The <code>aeme</code> object can be manipulated using the
<code>AEME</code> package functions. The functions are defined by the
slot names of the <code>aeme</code> object. For example, the
<code>lake</code> slot can be manipulated using the <code>lake</code>
function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load lake data</span></span>
<span><span class="va">lke</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lake.html">lake</a></span><span class="op">(</span><span class="va">aeme</span><span class="op">)</span></span>
<span><span class="co"># Print lake data to console</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">lke</span><span class="op">)</span></span>
<span><span class="co">#&gt; $name</span></span>
<span><span class="co">#&gt; [1] "Wainamu"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $id</span></span>
<span><span class="co">#&gt; [1] "LID45819"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $latitude</span></span>
<span><span class="co">#&gt; [1] -36.88921</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $longitude</span></span>
<span><span class="co">#&gt; [1] 174.4669</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $elevation</span></span>
<span><span class="co">#&gt; [1] 23.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $depth</span></span>
<span><span class="co">#&gt; [1] 13.48</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $area</span></span>
<span><span class="co">#&gt; [1] 153648</span></span>
<span></span>
<span><span class="co"># Change lake name</span></span>
<span><span class="va">lke</span><span class="op">[[</span><span class="st">"name"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"AEME"</span></span>
<span></span>
<span><span class="co"># reassign lake data to aeme object</span></span>
<span><span class="fu"><a href="../reference/lake.html">lake</a></span><span class="op">(</span><span class="va">aeme</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">lke</span></span>
<span></span>
<span><span class="va">aeme</span></span>
<span><span class="co">#&gt;             AEME </span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Lake</span></span>
<span><span class="co">#&gt; AEME (ID: LID45819); Lat: -36.89; Lon: 174.47; Elev: 23.2m; Depth: 13.48m;</span></span>
<span><span class="co">#&gt; Area: 153648 m2</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Time</span></span>
<span><span class="co">#&gt; Start: 2013-07-01; Stop: 2023-06-30; Time step: 3600</span></span>
<span><span class="co">#&gt;  Spin up (days): GLM: 1095; GOTM: 1095; DYRESM: 1095</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Configuration</span></span>
<span><span class="co">#&gt;     Model controls: Present</span></span>
<span><span class="co">#&gt;           Physical   |   Biogeochemical</span></span>
<span><span class="co">#&gt; DY-CD    : Absent     |   Absent </span></span>
<span><span class="co">#&gt; GLM-AED  : Present    |   Present</span></span>
<span><span class="co">#&gt; GOTM-WET : Present    |   Present</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Observations</span></span>
<span><span class="co">#&gt; Lake: Present; Level: Absent</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Input</span></span>
<span><span class="co">#&gt; Inital profile: Present; Inital depth: 13.48m; Hypsograph: Present (n=53);</span></span>
<span><span class="co">#&gt; Meteo: Present; Use longwave: TRUE; Kw: 1.214286</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Inflows</span></span>
<span><span class="co">#&gt; Data: Present; Scaling factors: DY-CD: 1; GLM-AED: 1; GOTM-WET: 1</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Outflows</span></span>
<span><span class="co">#&gt; Data: Present; Scaling factors: DY-CD: 1; GLM-AED: 1; GOTM-WET: 1</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Water balance</span></span>
<span><span class="co">#&gt; Method: 2; Use: obs; Modelled: Absent; Water balance: Present</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Parameters: </span></span>
<span><span class="co">#&gt; Number of parameters: 18</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Output: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; DY-CD:    </span></span>
<span><span class="co">#&gt; GLM-AED:  </span></span>
<span><span class="co">#&gt; GOTM-WET:</span></span></code></pre></div>
<div class="section level3">
<h3 id="visualisation">Visualisation<a class="anchor" aria-label="anchor" href="#visualisation"></a>
</h3>
<p>The <code>aeme</code> object can be visualised simply using the
<code>plot</code> function. The <code>plot</code> function can be
applied to the different slots of the <code>aeme</code> object. For
example, the <code>lake</code> slot can be visualised using the
<code>plot</code> function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">aeme</span>, <span class="st">"lake"</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-aeme_files/figure-html/aeme-visualisation-lake-1.png" width="672"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">aeme</span>, <span class="st">"input"</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-aeme_files/figure-html/aeme-visualisation-input-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="build-model-ensemble">Build Model Ensemble<a class="anchor" aria-label="anchor" href="#build-model-ensemble"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_controls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_model_controls.html">get_model_controls</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">inf_factor</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dy_cd"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"glm_aed"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"gotm_wet"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">outf_factor</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dy_cd"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"glm_aed"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"gotm_wet"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dy_cd"</span>, <span class="st">"glm_aed"</span>, <span class="st">"gotm_wet"</span><span class="op">)</span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="st">"aeme"</span></span>
<span><span class="va">aeme</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_aeme.html">build_aeme</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">path</span>, aeme <span class="op">=</span> <span class="va">aeme</span>, model <span class="op">=</span> <span class="va">model</span>,</span>
<span>                            model_controls <span class="op">=</span> <span class="va">model_controls</span>, inf_factor <span class="op">=</span> <span class="va">inf_factor</span>,</span>
<span>                            ext_elev <span class="op">=</span> <span class="fl">5</span>, use_bgc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Building simulation for AEME [2025-10-22 21:49:27]</span></span>
<span><span class="co">#&gt; Missing state variables in inflows: CHM_oxy</span></span>
<span><span class="co">#&gt; Added default values for missing variables.</span></span>
<span><span class="co">#&gt; Missing state variables in inflows: CHM_oxy</span></span>
<span><span class="co">#&gt; Added default values for missing variables.</span></span>
<span><span class="co">#&gt; Missing state variables in inflows: CHM_oxy</span></span>
<span><span class="co">#&gt; Added default values for missing variables.</span></span>
<span><span class="co">#&gt; Missing state variables in inflows: CHM_oxy</span></span>
<span><span class="co">#&gt; Added default values for missing variables.</span></span>
<span><span class="co">#&gt; Missing state variables in inflows: CHM_oxy</span></span>
<span><span class="co">#&gt; Added default values for missing variables.</span></span>
<span><span class="co">#&gt; Missing state variables in inflows: CHM_oxy</span></span>
<span><span class="co">#&gt; Added default values for missing variables.</span></span>
<span><span class="co">#&gt; No water level present. Using constant water level.</span></span>
<span><span class="co">#&gt; Correcting water balance using estimated outflows (method = 2).</span></span>
<span><span class="co">#&gt; Calculating lake level using lake depth and a sinisoidal function.</span></span>
<span><span class="co">#&gt; Building DYRESM-CAEDYM for lake aeme</span></span>
<span><span class="co">#&gt; Copied in DYRESM par file</span></span>
<span><span class="co">#&gt; Writing DYRESM configuration</span></span>
<span><span class="co">#&gt; [1] "TEMPTURE SALINITY DO"</span></span>
<span><span class="co">#&gt; Writing DYRESM control file</span></span>
<span><span class="co">#&gt; Building GLM3-AED2 model for lake aeme</span></span>
<span><span class="co">#&gt; Copied in GLM nml file</span></span>
<span><span class="co">#&gt; Copied in AED nml file</span></span>
<span><span class="co">#&gt;    oxy_initial   = 625 replaced with 312.5</span></span>
<span><span class="co">#&gt; GLM nml checks passed with no issues.</span></span>
<span><span class="co">#&gt; Building GOTM-WET for lake aeme</span></span>
<span><span class="co">#&gt; Copied all GOTM configuration files</span></span>
<span><span class="co">#&gt; instances/abiotic_water/initialization/sO2W 13 replaced with 10</span></span>
<span><span class="co">#&gt; Warning in input_model_parameters(aeme = aeme, model = model, param = param, :</span></span>
<span><span class="co">#&gt; No parameters in 'param' for dy_cd.</span></span>
<span><span class="co">#&gt; GLM nml checks passed with no issues.</span></span>
<span><span class="va">aeme</span></span>
<span><span class="co">#&gt;             AEME </span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Lake</span></span>
<span><span class="co">#&gt; AEME (ID: LID45819); Lat: -36.89; Lon: 174.47; Elev: 23.2m; Depth: 13.48m;</span></span>
<span><span class="co">#&gt; Area: 153648 m2</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Time</span></span>
<span><span class="co">#&gt; Start: 2013-07-01; Stop: 2023-06-30; Time step: 3600</span></span>
<span><span class="co">#&gt;  Spin up (days): GLM: 1095; GOTM: 1095; DYRESM: 1095</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Configuration</span></span>
<span><span class="co">#&gt;     Model controls: Present</span></span>
<span><span class="co">#&gt;           Physical   |   Biogeochemical</span></span>
<span><span class="co">#&gt; DY-CD    : Present    |   Present</span></span>
<span><span class="co">#&gt; GLM-AED  : Present    |   Present</span></span>
<span><span class="co">#&gt; GOTM-WET : Present    |   Present</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Observations</span></span>
<span><span class="co">#&gt; Lake: Present; Level: Absent</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Input</span></span>
<span><span class="co">#&gt; Inital profile: Present; Inital depth: 13.48m; Hypsograph: Present (n=53);</span></span>
<span><span class="co">#&gt; Meteo: Present; Use longwave: TRUE; Kw: 1.214286</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Inflows</span></span>
<span><span class="co">#&gt; Data: Present; Scaling factors: DY-CD: 1; GLM-AED: 1; GOTM-WET: 1</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Outflows</span></span>
<span><span class="co">#&gt; Data: Present; Scaling factors: DY-CD: 1; GLM-AED: 1; GOTM-WET: 1</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Water balance</span></span>
<span><span class="co">#&gt; Method: 2; Use: obs; Modelled: Absent; Water balance: Present</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Parameters: </span></span>
<span><span class="co">#&gt; Number of parameters: 18</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Output: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; DY-CD:    </span></span>
<span><span class="co">#&gt; GLM-AED:  </span></span>
<span><span class="co">#&gt; GOTM-WET:</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cfg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/configuration.html">configuration</a></span><span class="op">(</span><span class="va">aeme</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tadhg Moore, Christopher McBride.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
